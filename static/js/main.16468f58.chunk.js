(this["webpackJsonpreact-complete-project"]=this["webpackJsonpreact-complete-project"]||[]).push([[0],{16:function(e,t,a){},24:function(e,t,a){e.exports=a(35)},29:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(11),o=a.n(c),r=(a(29),a(1)),s=a(7),i=a(18),m=a(19),u=a(22),h=a(20),v=a(23),d=a(9);a(16);var E=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={client_token:"client token",server_token:"server token",profile:{},theme:""},a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.initialize(),d.getContext((function(e){e&&e.theme?(console.log(e),this.setState({theme:e.theme})):console.log("no theme")})),new Promise((function(e,t){console.log("1. Get auth token from Microsoft Teams"),d.authentication.getAuthToken({successCallback:function(t){e(t)},failureCallback:function(e){t("Error getting token: "+e),console.log("Error getting token")}})})).then((function(t){return e.setState((function(e,a){return{client_token:t}})),function(e){return new Promise((function(t,a){d.getContext((function(n){fetch("/auth/token",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({tid:n.tid,token:e}),mode:"cors",cache:"default"}).then((function(e){if(e.ok)return e.json();a(e.error)})).then((function(e){e.error?a(e.error):t(e)}))}))}))}(t)})).then((function(t){return console.log(t),e.setState((function(e,a){return{server_token:t}})),fetch("https://graph.microsoft.com/v1.0/me/",{method:"GET",headers:{accept:"application/json",authorization:"bearer "+t},mode:"cors",cache:"default"}).then((function(e){if(e.ok)return e.json();throw"Error ".concat(e.status,": ").concat(e.statusText)})).then((function(e){return e}))})).then((function(t){console.log(t),e.setState((function(e,a){return{profile:t}}))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Demo 1 tokens")),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"Theme"),l.a.createElement("div",{className:"col-sm-9"},this.state.theme)),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"client token"),l.a.createElement("div",{className:"col-sm-9"},this.state.client_token)),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"server token"),l.a.createElement("div",{className:"col-sm-9"},this.state.server_token)),l.a.createElement("br",null),l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Profile")),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("p",null,"Name:"),l.a.createElement("p",null,"Email:"),l.a.createElement("p",null,"id:")),l.a.createElement("div",{className:"col-sm-9"},l.a.createElement("p",null,this.state.profile.displayName),l.a.createElement("p",null,this.state.profile.mail),l.a.createElement("p",null,this.state.profile.id)))))}}]),t}(l.a.Component);function f(){var e=Object(r.f)().slug;return l.a.createElement("div",null,"Now showing post ",e)}var p=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(s.a,null,l.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},l.a.createElement("div",{className:"container-fluid"},l.a.createElement(s.b,{className:"navbar-brand",to:"/"},"Hsenid Biz"),l.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},l.a.createElement("span",{className:"navbar-toggler-icon"})),l.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},l.a.createElement("ul",{className:"navbar-nav"},l.a.createElement("li",{className:"nav-item"},l.a.createElement(s.b,{className:"nav-link",to:"/React-h-biz"},"Home")),l.a.createElement("li",{className:"nav-item"},l.a.createElement(s.b,{className:"nav-link",to:"/React-h-biz/ssoDemo"},"ssoDemo")),l.a.createElement("li",{className:"nav-item"},l.a.createElement(s.b,{className:"nav-link",to:"/config/:slug"},"Config")),l.a.createElement("li",{className:"nav-item"},l.a.createElement("a",{className:"nav-link disabled",href:"#",tabindex:"-1","aria-disabled":"true"},"Disabled")))))),l.a.createElement(r.c,null,l.a.createElement(r.a,{exact:!0,path:"/React-h-biz"},l.a.createElement(E,null)),l.a.createElement(r.a,{exact:!0,path:"/React-h-biz/ssoDemo"},l.a.createElement(E,null)),l.a.createElement(r.a,{path:"config/:slug"},l.a.createElement(f,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[24,1,2]]]);
//# sourceMappingURL=main.16468f58.chunk.js.map